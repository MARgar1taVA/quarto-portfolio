---
title: "Dengue Cases in Mexico"
author: "Margarita Valdés A."
date: "2024-06-20"
description: "This analysis shows the dengue virus cases in Mexico at the start of 2024"
categories: [Data Wrangling, R, Data Visualization, Tableau]
title-block-banner: "#D3E9EC"
image: "dengue_dashboard.png"
format:
  html:
    toc: true
    df-print: paged
draft: false
---

# Dengue cases in Mexico (2024)

For this analysis, the data wrangling was done with **R** using the {tidyverse} library of packages. To visualize the data I made an [interactive dashboard in **Tableau**](https://public.tableau.com/app/profile/margarita.vald.s.alem.n/viz/Casos_dengue_2024_17189339253630/CasosDengue).

### 1) About the data

The data for this project was downloaded from the Mexican [Health Secretary](https://datos.gob.mx/busca/dataset/bases-de-datos-dengue-en-mexico) database webpage. The collected data spans from the 1st of January to the 4th of June 2024. The day cases are recorded are later than the reported date of the start of symptoms, so the monitoring of cases has a lag between the symptoms and when they are reported, which can be several days later.

Three files were downloaded: 1) the first is a .csv file with the actual dengue data [Database of Dengue in Mexico](https://datos.gob.mx/busca/dataset/bases-de-datos-dengue-en-mexico/resource/6c2f401c-2005-4403-857f-472388a326d1) (even thought the title is not updated and it says 2020, after inspecting it, the file does indeed contain the 2024 data). 2) The second and 3) third are .xlsx files, and they are downloaded together in a folder. They contain the [Dictionary and Catalog of Dengue](https://datos.gob.mx/busca/dataset/bases-de-datos-dengue-en-mexico/resource/6e63b32e-14b4-45b2-951b-a5f872deb99c). The catalog contains the keys for all the variables in the dengue database, and the dictionary contains the description of the variables.

### 2) Data Wrangling

#### a) Importing the data

First, I imported the "dengue_abierto.csv" file to R Studio as a tibble. I inspected the columns and rows, and found there are 78,184 observations and 28 variables. Most of the variables are coded in keys, which are translated later on.

```{r}
#| label: read-file
#| warning: false

library(tidyverse)
(casos <- read_csv(file = "dengue_abierto.csv"))

```

#### b) Selecting working variables

I decided which variables I was interested in analyzing and selected those columns, to only focus on that data. The variables I selected contained the: ID, sex, age, state of residency, date of intial symptoms, type of patient, hemorrhagic cases, death cases, if they were sampled, PCR results, and status of the case.

```{r}
#| label: selecting-variables
#| output: false

(selected_variables <- casos %>% 
          select(ID_REGISTRO,
                 SEXO,
                 EDAD_ANOS,
                 ENTIDAD_RES,
                 FECHA_SIGN_SINTOMAS,
                 TIPO_PACIENTE,
                 HEMORRAGICOS,
                 DEFUNCION,
                 DICTAMEN,
                 TOMA_MUESTRA,
                 RESULTADO_PCR,
                 ESTATUS_CASO))

```

#### c) Re-writing keys

Using the file "Catalogos_Dengue.xlsx" I renamed the keys on the working variables I selected, to understand the data set I was working with. As an example, keys (in numbers) were used to declare if a variable was negative or positive, the state of residency, the sex, etc.

```{r}
#| label: keys
#| output: true

(rename_variables <- selected_variables %>% 
          mutate(SEXO = case_when(SEXO == 1 ~ "Mujer",
                                  SEXO == 2 ~ "Hombre")) %>% 
          mutate(ENTIDAD_RES = case_when(ENTIDAD_RES == "01" ~ "Aguascalientes",
                                    ENTIDAD_RES == "02" ~ "Baja California",
                                    ENTIDAD_RES == "03" ~ "Baja California Sur",
                                    ENTIDAD_RES == "04" ~ "Campeche",
                                    ENTIDAD_RES == "05" ~ "Coahuila",
                                    ENTIDAD_RES == "06" ~ "Colima",
                                    ENTIDAD_RES == "07" ~ "Chiapas",
                                    ENTIDAD_RES == "08" ~ "Chihuahua",
                                    ENTIDAD_RES == "09" ~ "Ciudad de México",
                                    ENTIDAD_RES == "10" ~ "Durango",
                                    ENTIDAD_RES == "11" ~ "Guanajuato",
                                    ENTIDAD_RES == "12" ~ "Guerrero",
                                    ENTIDAD_RES == "13" ~ "Hidalgo",
                                    ENTIDAD_RES == "14" ~ "Jalisco",
                                    ENTIDAD_RES == "15" ~ "México",
                                    ENTIDAD_RES == "16" ~ "Michoacán",
                                    ENTIDAD_RES == "17" ~ "Morelos",
                                    ENTIDAD_RES == "18" ~ "Nayarit",
                                    ENTIDAD_RES == "19" ~ "Nuevo León",
                                    ENTIDAD_RES == "20" ~ "Oaxaca",
                                    ENTIDAD_RES == "21" ~ "Puebla",
                                    ENTIDAD_RES == "22" ~ "Querétaro",
                                    ENTIDAD_RES == "23" ~ "Quintana Roo",
                                    ENTIDAD_RES == "24" ~ "San Luis Potosí",
                                    ENTIDAD_RES == "25" ~ "Sinaloa",
                                    ENTIDAD_RES == "26" ~ "Sonora",
                                    ENTIDAD_RES == "27" ~ "Tabasco",
                                    ENTIDAD_RES == "28" ~ "Tamaulipas",
                                    ENTIDAD_RES == "29" ~ "Tlaxcala",
                                    ENTIDAD_RES == "30" ~ "Veracruz",
                                    ENTIDAD_RES == "31" ~ "Yucatán",
                                    ENTIDAD_RES == "32" ~ "Zacatecas",
                                    ENTIDAD_RES == "33" ~ "Otros paises",
                                    ENTIDAD_RES == "34" ~ "Otros paises",
                                    ENTIDAD_RES == "35" ~ "Otros paises",
                                    .default = as.character(ENTIDAD_RES))) %>% 
           mutate(TIPO_PACIENTE = case_when(TIPO_PACIENTE == 1 ~ "ambulatorio",
                                            TIPO_PACIENTE == 2 ~ "hospitalizado")) %>% 
           mutate(HEMORRAGICOS = case_when(HEMORRAGICOS == 1 ~ "hemorragico",
                                           HEMORRAGICOS == 2 ~ "no hemorragico")) %>% 
           mutate(DEFUNCION = case_when(DEFUNCION == 1 ~ "si",
                                        DEFUNCION == 2 ~ "no")) %>% 
           mutate(DICTAMEN = case_when(DICTAMEN == 1 ~ "dengue",
                                       DICTAMEN == 2 ~ "chikungunya",
                                       DICTAMEN == 3 ~ "negativo",
                                       DICTAMEN == 4 ~ "en estudio",
                                       DICTAMEN == 5 ~ "no aplica")) %>% 
           mutate(TOMA_MUESTRA = case_when(TOMA_MUESTRA == 1 ~ "si",
                                           TOMA_MUESTRA == 2 ~ "no")) %>% 
           mutate(RESULTADO_PCR = case_when(RESULTADO_PCR == 1 ~ "DENV1",
                                            RESULTADO_PCR == 2 ~ "DENV2",
                                            RESULTADO_PCR == 3 ~ "DENV3",
                                            RESULTADO_PCR == 4 ~ "DENV4",
                                            RESULTADO_PCR == 5 ~ "sin serotipo aislado")) %>% 
           mutate(ESTATUS_CASO = case_when(ESTATUS_CASO == 1 ~ "probable",
                                           ESTATUS_CASO == 2 ~ "confirmado",
                                           ESTATUS_CASO == 3 ~ "descartado"))
                   
 )
          

```

#### d) Filtering out negative cases

As I was only interested in working with the possible positive cases, I filtered the variable containing the "status of the case" to only keep the **confirmed** and the **possible** cases, and to filter out negative cases. Afterwards, I saved the cleaned and filterd data as a .csv file.

```{r}
#| label: casos-positivos
#| output: false

(positive_cases <- rename_variables %>% 
          filter(ESTATUS_CASO != "descartado")) 

# write_csv(positive_cases,
#           file = "positive_dengue_cases.csv")

```

### 3) Data Visualization

The visualization was done in the Tableau Public desktop app. I imported the "positive_dengue_cases.csv" to the app and proceeded to explore the data and finally decided to show the data for daily cases (as a bar chart), the cases per state (as a map), and the isolated serotypes of the dengue virus, the number of hemorrhagic cases divided by sex, and the number of deaths divided on weather they were hospitalized or outpatient.

> **Important note:** The shown dates of start of symptoms differ from the day cases are reported and there is a lag of several days between when cases start and when they get reported. Therefore, the effect of cases dropping in the last days is due to this lag, not to the actual drop in cases.

```{=html}
<div class='tableauPlaceholder' id='viz1718934615445' style='position: relative'><noscript><a href='#'><img alt='Casos de Dengue en México (2024) ' src='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;Ca&#47;Casos_dengue_2024_17189339253630&#47;CasosDengue&#47;1_rss.png' style='border: none' /></a></noscript><object class='tableauViz'  style='display:none;'><param name='host_url' value='https%3A%2F%2Fpublic.tableau.com%2F' /> <param name='embed_code_version' value='3' /> <param name='site_root' value='' /><param name='name' value='Casos_dengue_2024_17189339253630&#47;CasosDengue' /><param name='tabs' value='no' /><param name='toolbar' value='yes' /><param name='static_image' value='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;Ca&#47;Casos_dengue_2024_17189339253630&#47;CasosDengue&#47;1.png' /> <param name='animate_transition' value='yes' /><param name='display_static_image' value='yes' /><param name='display_spinner' value='yes' /><param name='display_overlay' value='yes' /><param name='display_count' value='yes' /><param name='language' value='en-US' /><param name='filter' value='publish=yes' /></object></div>                <script type='text/javascript'>                    var divElement = document.getElementById('viz1718934615445');                    var vizElement = divElement.getElementsByTagName('object')[0];                    if ( divElement.offsetWidth > 800 ) { vizElement.style.width='960px';vizElement.style.height='761px';} else if ( divElement.offsetWidth > 500 ) { vizElement.style.width='100%';vizElement.style.height=(divElement.offsetWidth*1.2)+'px';} else { vizElement.style.width='100%';vizElement.style.height='1377px';}                     var scriptElement = document.createElement('script');                    scriptElement.src = 'https://public.tableau.com/javascripts/api/viz_v1.js';                    vizElement.parentNode.insertBefore(scriptElement, vizElement);                </script>
```
